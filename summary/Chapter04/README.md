# Chapter 04

## 도전과제

환자들의 진료 기록을 추적하는 문서를 관리하는 과정을 자동홯 ㅏ자.

## 목표

- 다양한 소프트웨어 개발 원칙 학습
- 상속관계, 인터페이스 구현
- 리스코프 치환 원칙
- 상속보다 조합 원칙
- 유지보수가 쉽고 좋은 테스트를 만드는 방법을 활용해 기존에 배운 자동화된 코드 구현 지식을 확장

## 요구사항

- 기존 환자 정보 파일을 읽어 색인을 추가하고, 검색할 수 있는 형태의 정보로 변환
- 각기 다른 문서 형식
    - 리포트 : 환자의 수술과 관련된 상담 내용 기록
    - 우편물 : 특정 주소로 발송되는 텍스트 문서
    - 이미지 : 치아와 잇몸 엑스레이 사진 저장. 용량이 큼
- 각각의 문서는 관리 대상 파일의 경로와 어떤 환자의 기록물인지를 나타내는 정보도 포함한다.
- 다양한 문서에서 특정 정보를 포함하는 문서 검색

## 리스코프 치환 원칙(LSP, Liskov Substitution Principle)

- 클래스 상속과 인터페이스 구현을 올바르게 사용하도록 도와줌
- SOLID 원칙중 L에 해당
- 형식(Type)이란 용어는 클래스나 인터페이스를 떠올리자.
- 하위형식(Subtype)이란 용어는 두 형식이 부모와 자식 관계를 이루었음을 의미한다.
- 간편하게 자식 클래스는 부모로부터 물려받은 행동을 유지해야한다.

q(x)는 T 형식의 x 객체를 증명할 수 있는 공식이다. 그러면 S 형식의 객체 y가 있고, S 가 T의 하위 형식이라면 q(y)는 참이다.

### 하위 형식에서 선행 조건을 더할 수 없음

선행조건은 어떤 코드가 동작하는 조건을 결정한다.
`Importer` 구현은 임포트하려는 파일이 존재하며, 읽을 수 있을 것이라는 선행조건을 가진다. 따라서 `Importer`를 실행하기 전에 검증을
수행하는 `DocumentManagementSystem.importFile` 메서드가 필요하다.

부모가 문서의 크기를 제한하지 않았다면, 문서의 크기가 특정 크기보다 작아야 한다고 요구할 수는 없다.

### 하위 형식에서 후행조건을 약화시킬 수 없음

후행조건은 어떤 코드를 실행한 다음에 만족 해야 하는 규칙이다. 유효한 파일에 `importFile()`을 실행했다면 `contents()`가 반환하는 문서 목록에 그 파일이 반드시 포함되어야 한다. 즉, 부모가
부작용을 포함하거나 어떤 값을 반환한다면 자식도 그래야 한다.

### 슈퍼형식의 불변자는 하위형식에서 보존됨

상속 관계의 부모와 자식 클래스가 있을 때, 부모 클래스에서 유지되는 모든 불변자는 자식 클래스에서도 유지되어야 한다.

### 히스토리 규칙

기본적으로 자식 클래스는 부모가 허용하지 않은 상태 변화를 허용하지 않아야 한다. 예제의 `Document` 는 바꿀 수 없는 불변 클래스다. 즉, Document 클래스를 인스턴스화한 다음에는 어떤 속성도
삭제,추가,변경할 수 없다. 모든 부모 클래스의 사용자는 `Document` 클래스의 메서드를 호출했을 때 어떤 일이 일어날 수 있음을 인지하고 있다.